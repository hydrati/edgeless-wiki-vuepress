# :-: Edgeless在没有附加插件的情况下支持安装iso/wim/esd/gho等多种格式的镜像
## :-: **此教程只提供安装最新版本Windows10的教程**
## PS：如果您习惯于使用某种第三方安装工具，您或许可以在我们的 插件包-系统安装+备份还原 内发现它
## 如果你的电脑硬件比较新（所有硬件均支持UEFI启动并且配置了SSD），我们强烈建议你使用我们提供的教程（5.1和5.2章节的方案一）而不是第三方安装工具安装，因为这样能确保Windows在启动引导上发挥它的最佳性能（如支持5秒以内的快速启动）
<br/>

# 安装原版iso镜像（强烈推荐）

### 1、从[MSDN](https://msdn.itellyou.cn/)下载Windows10原版镜像。你也可以使用Edgeless定制的“[Microsoft Download](https://down.edgeless.top)”软件获取下载链接

<br/>
<br/>

### 2、备份C盘内的重要文件
<br/>
<br/>
<br/>

### 3、将目标磁盘清空（删除分区数据）。如果盘的后端有数据需要保存，则**清空前端分区即可**（从恢复分区到ESP分区到MSR分区到系统盘（通常盘符为C）分区）
<br/>
<br/>
以我自己的电脑为例，如果要重装则下方图中的所有分区都需要清空
<br/>
假设C盘之后有D盘、E盘，那么D盘、E盘可以保留不清空
<br/>
<br/>

![](images/图像1_1564069746769.png)
<br/>
![](images/图像2_1564071756150.png)

<br/>

<br/>

### 4、双击下载得到的ISO镜像
在Edgeless3.0.0及以下版本中，选择使用“Edgeless智能虚拟光驱”打开，程序会自动运行安装程序
在Edgeless3.0.0以上版本中，会弹出Edgeless的安装系统镜像窗口
#### **我们首先推荐使用第一个选项“使用Windows原版安装程序”**

#### **如果使用此选项在安装过程中出现了问题，请注意：我们依旧建议您选择“使用Windows原版安装程序”安装Windows系统，请在[MSDN](https://msdn.itellyou.cn/)选择其他版本的原装镜像下载使用**

#### 万不得已，请选择使用第二个选项“使用第三方工具NTSetup”并移步5.2章节

<br/>

<br/>


### 5.1、选择“使用Windows原版安装程序”

#### 根据提示开始安装系统。之后的步骤请参考微软官方说明（略有改动）：

<br/>

<br/>

>1.  在初始设置屏幕上，输入语言和其他首选项，然后选择“下一步”。如果你未看到设置屏幕，你的电脑可能未设置为从驱动器启动。有关如何更改电脑的启动顺序的信息，请查看你的电脑制造商的网站，然后重试。
>2.  选择“立即安装”。
>3.  在“输入产品密钥以激活 Windows”页面上，输入产品密钥（如果有）。如果你已免费升级到 Windows 10 或已从 Microsoft Store 购买和激活 Windows 10，请选择“跳过”，Windows 将在以后自动激活。有关更多详细信息，请参阅[Windows 10 中的激活](https://support.microsoft.com/zh-cn/help/12440)。
>4.  在“许可条款”页面上，选择“我接受许可条款”（如果同意这些条款），然后选择“下一步”。
>5.  在“你想进行何种类型的安装？”页面上，选择“自定义”。
>6.  在“要将 Windows 安装在哪里？”页面上，选择分区（**Edgeless团队注：选择刚刚释放出来的空地，即“未分配的空间”**），然后按照说明进行操作。
>7.  完成格式化后，选择“下一步”。
>8.  按照安装说明的其余步骤完成 Windows 10 安装。

<br/>

<br/>

### 5.2、选择“使用第三方工具NTSetup”
> 2020-5-13补充：此处关于NTSetup的使用依据个人的装机经验编写，并不是很严谨甚至可能存在某些错误，请辩证看待；如果您认为某些地方需要修改请联系我们
### **引言：**
* 如果你缺少系统安装的经验，很不幸你来到了此处，微软官方提供的工具一定是最好用的，可惜你没有用
* 如果你的电脑比较新，推荐先看方案一（UEFI引导），但是这种方案稍有些复杂
* 如果你的电脑比较老旧，推荐使用方案二（Legacy引导）
### **方案一（UEFI+GPT，完全模拟微软官方安装工具进行分区）**
#### **首先确定目标磁盘的分区表格式**
1. 打开DiskGenius，找到准备安装系统的磁盘
2. 在左侧窗口中右键磁盘，**如果“转换分区表类型为GUID格式”选项是灰色的——恭喜，请跳转到下一小节**；**如果“转换分区表类型为GUID格式”选项是可用的**（如下图）——很不幸，此磁盘的分区表是MBR格式，**我们建议你立即转到方案二**
![](images/screenshot_1574937751744.png)
如果你认为你的电脑比较好，需要为它认认真真地装一个系统，并且有条件清空整块磁盘，那么请进行如下步骤
* 备份好盘内重要数据
* 在磁盘上右键——删除所有分区
![](images/screenshot_1574937695177.png)
* 再次右键磁盘，选择“转换分区表类型为GUID格式”
![](images/screenshot_1574937751744.png)
* 点击左上角的保存更改，等待操作完成。恭喜你，你已经获得了一块干净的GPT磁盘
![](images/screenshot_1574938950444.png)

#### **分区**
1. 关闭DiskGenius，按下“Win+R”快捷键或者点击开始菜单内的“运行”按钮，输入`cmd`并回车
![](images/screenshot_1574939392394.png)
2. 在弹出的窗口中输入`diskpart`并回车，再输入`list disk`
![](images/screenshot_1574939590385.png)
3. 根据大小和未分配空间（可用）判断目标磁盘是磁盘几，这里假设目标磁盘为磁盘0
4. 依次输入`sel disk 0`（如果是磁盘3就输入sel disk 3，以此类推） `cre par efi size=168`和`cre par msr size=188`并分别回车
![](images/screenshot_1574941741366.png)
![](images/screenshot_1574939709719.png)
5. 输入`exit`并回车，然后关闭窗口。此时磁盘的EFI和MSR分区已经创建完成了
6. 重新打开DiskGenius，此时应该能看到磁盘的前端有两个小分区，后面跟着一块灰色的未分配空间。**在那块灰色的未分区空间上右键——新建分区**，点击确定后再次点击左上角的“保存更改”，并点击两次确定进行格式化
![](images/screenshot_1579586433103.png)

#### **安装**
1. 打开你的Windows镜像，选择第二个选项“使用第三方工具NTSetup”（或直接打开wim/esd文件）
2. 如果你前面的步骤都正确，你会看到NTSetup的“GPT”和“EFI PART”灯是绿色的
![](images/screenshot_1574940627909.png)
3. 选择安装驱动器位置，即在那片灰色未分配空间上新建的较大的分区
4. 勾选右下角的“模式”复选框并选择一个绿色的选项
![](images/screenshot_1574940777857.png)
5. 点击开始安装，等待安装完成
<br/>

<br/>

### **方案二（Legacy或其他UEFI）**
#### 此方案较为简单，但是Windows启动较慢
1. 打开DiskGenius，在那块灰色的区域上右键——新建分区，继续右键——设置为主分区，——，点击左上角的保存更改并退出
2. 打开你的Windows镜像，选择第二个选项“使用第三方工具NTSetup”（或直接打开wim/esd文件）
3. 如果你先前没有删除EFI分区（没完全按照教程的步骤做），引导驱动器可能会自动填充Z:，那就保持这个不用管了。如果引导驱动器为空，选择目标磁盘的活动分区（通常为磁盘的第一个分区）
4. 安装驱动器选择在第一步新建的分区。如果你之前没有完全按照教程做，没有经历清空再新建分区的过程，那么记得将安装分区格式化
5. 勾选右下角的“模式”复选框并选择一个绿色的选项
![](images/screenshot_1574940777857.png)

6. 点击开始安装，等待安装完成

<br/>

# 安装wim/esd镜像
广告：从哪获得这种镜像？—— [Windsys Project](https://windsys.whatk.me/)  ![内裤滑稽](images/pc.gif)
### Edgeless2.2.0以上版本已经将wim/esd文件做了与NTSetup的关联，双击wim/esd文件即可打开NTSetup进行安装
### Edgeless2.2.0及以下版本：运行Edgeless桌面上的NTSetup进行安装
## **安装方法参考上方的5.2章节**



<br/>

<br/>

# 安装gho镜像（极度不推荐！！！）
### Edgeless团队强烈建议您迅速抛弃gho这种过时且不可靠的安装方式！
如果您仍旧需要安装gho镜像，请打开 开始菜单-CGI 进行安装操作
如果您需要长期使用CGI进行安装，我们为您提供了添加CGI快捷方式的插件，请根据需要添加（在“系统安装&备份还原”文件夹内）


<br/>

<br/>

